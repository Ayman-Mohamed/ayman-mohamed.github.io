webpackJsonp([0],{suUD:function(t,e,n){"use strict";function i(t){return o._14(0,[(t()(),o.Y(0,0,null,null,0,"canvas",[],[[8,"id",0],[8,"width",0],[8,"height",0]],null,null,null,null))],null,function(t,e){var n=e.component;t(e,0,0,n.id,n.width,n.height)})}function s(t){return o._14(0,[o._11(402653184,1,{canvas:0}),(t()(),o.Y(1,0,null,null,1,"button",[["class","btn btn-default btn-sm"]],null,[[null,"click"]],function(t,e,n){var i=!0;return"click"===e&&(i=!1!==t.component.start()&&i),i},null,null)),(t()(),o._13(-1,null,["Run"])),(t()(),o._13(-1,null,["\n"])),(t()(),o.Y(4,0,null,null,0,"br",[],null,null,null,null,null)),(t()(),o._13(-1,null,["\n"])),(t()(),o.Y(6,0,null,null,1,"enhanced-canvas",[["id","tspcanvas"]],null,null,null,i,l)),o.X(7,114688,[[1,4]],0,h.a,[],{id:[0,"id"],width:[1,"width"],height:[2,"height"]},null)],function(t,e){var n=e.component;t(e,7,0,"tspcanvas",n.width,n.height)},null)}Object.defineProperty(e,"__esModule",{value:!0});var o=n("LMZF"),r=n("QC9w"),u=function(){return new r.a},a=function(){},h=n("WItM"),l=o.W({encapsulation:0,styles:["canvas[_ngcontent-%COMP%] {\n            border : 1px solid #ccc;\n        }"],data:{}}),c=function(){function t(t,e,n){this.fitness=t,this.crossOver=e,this.mutation=n}return t.prototype.calculateFitness=function(t){var e=this.fitness.calculateFitness(t);return t.fitness=e},t.prototype.crossover=function(t,e){return this.crossOver.getChild(t,e)},t.prototype.mutate=function(t){return this.mutation.mutate(t)},t.prototype.forceMutate=function(t){return this.mutation.forceMutate(t)},t}(),p=function(){function t(t){this.distance=t}return t.prototype.calculateFitness=function(t){for(var e=0,n=0,i=t.length,s=i-1;n<i;n++,s=(s+1)%i)e+=this.distance.distanceByIndex(t.genes[n].value,t.genes[s].value);return 1e5-e},t}(),f=function(){function t(){this.All=[]}return t.prototype.next=function(t){var e=this.All[t];return e.Next?e.Next.value:this.Head.value},t.prototype.prev=function(t){var e=this.All[t];return e.Prev?e.Prev.value:this.Tail.value},t.prototype.remove=function(t){var e=this.All[t];e.Prev&&(e.Prev.Next=e.Next),e.Next&&(e.Next.Prev=e.Prev),e==this.Head&&(this.Head=e.Next),e==this.Tail&&(this.Tail=e.Prev)},t.prototype.addAfter=function(t,e){if(void 0===e&&(e=-1),-1==e)this.Head=new d(t),this.Tail=this.Head,this.All[t]=this.Head;else{var n=this.All[e],i=new d(t);i.Prev=n,n.Next=i,this.Tail=i,this.All[t]=i}return this},t}(),d=function(t){this.value=t},v=function(){function t(){this.genes=[],this.fitness=0}return Object.defineProperty(t.prototype,"length",{get:function(){return this.genes.length},enumerable:!0,configurable:!0}),t.prototype.add=function(t){this.genes.push(t)},t.prototype.clone=function(){for(var e=new t,n=0;n<this.genes.length;n++)e.genes.push(this.genes[n].clone());return e.fitness=this.fitness,e},t.prototype.swap=function(t,e){var n=this.genes[t];this.genes[t]=this.genes[e],this.genes[e]=n},t}(),y=function(){function t(t){this.value=t}return t.prototype.clone=function(){var e=new t;return e.value=this.value,e},t}(),m=function(){function t(t,e,n){this.mutation=t,this.distance=e,this.rnd=n}return t.prototype.getChild=function(t,e){return this.getChildByLookingForward(t,e)},t.prototype.getChildByLookingForward=function(t,e){for(var n,i=t.length,s=new f,o=new f,r=-1,u=-1,a=0;a<i;a++)s.addAfter(n=t.genes[a].value,r),r=n,o.addAfter(n=e.genes[a].value,u),u=n;var h=new v,l=this.rnd.next(i);h.add(new y(l));for(var c=i;c>1;){var p=s.next(l),d=o.next(l);s.remove(l),o.remove(l),c--;var m=this.distance.distanceByIndex(l,p),g=this.distance.distanceByIndex(l,d);h.add(new y(l=m<g?p:d))}return h},t}(),g=function(){function t(t,e){this.rnd=t,this.distance=e,this.mutationRate=.05}return t.prototype.setMutationRate=function(t){if(t<0||t>1)throw new TypeError("Muration Rate must be a number between 0 and 1");this.mutationRate=t},t.prototype.mutate=function(t){this.rnd.next()<this.mutationRate||this.forceMutate(t)},t.prototype.forceMutate=function(t){var e=this.rnd.next(3);0===e?this.randomPositionMutate(t):1===e?this.threePiecesMutate(t):this.neighbourMutate(t)},t.prototype.randomPositionMutate=function(t){for(var e=t.length,n=0;n<e/2;n++){var i=this.rnd.next(e-1),s=this.rnd.next(e-1);t.swap(i,s)}},t.prototype.threePiecesMutate=function(t){var e=t.genes,n=t.length,i=this.rnd.next(n-5),s=this.rnd.next(i,n-1),o=e.slice(0,i),r=e.slice(i,s),u=e.slice(s,n);t.genes=r.concat(o).concat(u)},t.prototype.neighbourMutate=function(t){for(var e=t.genes,n=t.length,i=0;i<n-1;i++){var s=0;i>0&&(s+=this.distance.distanceByIndex(e[i-1].value,e[i].value)),i+2<n&&(s+=this.distance.distanceByIndex(e[i+1].value,e[i+2].value)),t.swap(i,i+1);var o=0;i>0&&(o+=this.distance.distanceByIndex(e[i-1].value,e[i].value)),i+2<n&&(o+=this.distance.distanceByIndex(e[i+1].value,e[i+2].value)),o>s&&t.swap(i,i+1)}},t}(),b=function(t,e){this.x=t,this.y=e},w=function(){function t(){this.chromosomes=[]}return Object.defineProperty(t.prototype,"length",{get:function(){return this.chromosomes.length},enumerable:!0,configurable:!0}),t.prototype.push=function(t){this.chromosomes.push(t)},t}(),_=function(){function t(t,e,n,i,s,o){this.title=t,this.tspSrv=e,this.rnd=n,this.distance=i,this.roulette=s,this.util=o,this.width=700,this.height=500,this.bestFitness=0,this.currentGeneration=0,t.setTitle("TSP With Genetic Algorithm")}return t.prototype.ngAfterViewInit=function(){this.canvas.clear(),this.start()},t.prototype.start=function(){var t=this;this.initialize();var e=500,n=function(){t.run(),setTimeout(function(){e--&&n()},1)};n()},t.prototype.run=function(){this.calculateFitness(),this.runGeneration()},t.prototype.initialize=function(){this.bestGene=void 0,this.bestLocalGene=void 0,this.bestFitness=0,this.bestLocalFitness=0,this.currentGeneration=0,this.lastFitnessCount=0,this.cities=[],this.populationSize=100,this.numberOfCities=200;for(var t=[],e=0;e<this.numberOfCities;e++)this.cities[e]=new b(this.rnd.next(10,this.width-10),this.rnd.next(10,this.height-10)),t[e]=e;for(this.distance.registerCities(this.cities),this.population=new w,e=0;e<this.populationSize;e++){var n=new v;n.genes=this.util.shuffleArray(t.map(function(t){return new y(t)})),this.population.push(n)}},t.prototype.runGeneration=function(){this.currentGeneration++;var t=new w;if(this.bestGene){t.push(this.bestGene.clone());var e=this.bestGene.clone();this.tspSrv.forceMutate(e),t.push(e.clone()),this.tspSrv.forceMutate(e),t.push(e.clone()),t.push(e)}for(;t.length<this.populationSize;){var n=this.roulette.select(this.population),i=this.roulette.select(this.population),s=this.tspSrv.crossover(n,i);this.tspSrv.mutate(s),t.push(s)}this.population=t},t.prototype.calculateFitness=function(){for(var t=0;t<this.populationSize;t++)this.tspSrv.calculateFitness(this.population.chromosomes[t]);this.population.chromosomes.sort(function(t,e){return e.fitness-t.fitness}),this.bestLocalGene=this.population.chromosomes[0].clone(),this.bestLocalFitness=this.bestLocalGene.fitness,this.roulette.normalizeFitness(this.population),this.checkGeneratinoResults()},t.prototype.checkGeneratinoResults=function(){this.bestFitness<this.bestLocalFitness?(this.bestFitness=this.bestLocalFitness,this.bestGene=this.bestLocalGene,console.log("new best at gen "+this.currentGeneration+". f = "+this.bestFitness),this.canvas.draw(this.cities,this.bestGene.genes.map(function(t){return t.value})),this.lastFitnessCount=1):this.lastFitnessCount++},t}(),x=n("RyBE"),F=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])};return function(e,n){function i(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}(),C=function(t){function e(e){return t.call(this,e)||this}return F(e,t),e}(Error),M=function(){function t(){this.distanceTable=[]}return t.prototype.registerCities=function(t){var e=t.length;this.numberOfCities=e,this.distanceTable=[];for(var n=0;n<e;n++){this.distanceTable.push([]);for(var i=0;i<e;i++)this.distanceTable[n].push(this.cityDistance(t[n],t[i]))}},t.prototype.distanceByIndex=function(t,e){if(t<0||t>=this.numberOfCities)throw new C("Index "+t+" is out of bounds. Number of Cities = "+this.numberOfCities);if(e<0||e>=this.numberOfCities)throw new C("Index "+e+" is out of bounds. Number of Cities = "+this.numberOfCities);return this.distanceTable[t][e]},t.prototype.cityDistance=function(t,e){return this.distance(t.x,t.y,e.x,e.y)},t.prototype.distance=function(t,e,n,i){return Math.sqrt((t-n)*(t-n)+(e-i)*(e-i))},t}(),G=function(){function t(t){this.rnd=t}return t.prototype.normalizeFitness=function(t){this.normalizedFitness=[];for(var e=t.chromosomes.reduce(function(t,e){return t+e.fitness},0),n=0,i=t.chromosomes.length;n<i;n++)this.normalizedFitness.push(t.chromosomes[n].fitness/e)},t.prototype.select=function(t){for(var e=this.rnd.next(),n=0,i=0,s=t.length;i<s;i++)if((n+=this.normalizedFitness[i])>=e)return t.chromosomes[i];throw new TypeError("Couldn't select a parent from the population")},t}(),P=function(){function t(t){this.rnd=t}return t.prototype.cloneArray=function(t){return t.slice()},t.prototype.shuffleArray=function(t){var e=this;return this.cloneArray(t).sort(function(t,n){return e.rnd.next()-.5})},t}(),A=o.W({encapsulation:2,styles:[],data:{}}),O=o.U("tsp-ga",_,function(t){return o._14(0,[(t()(),o.Y(0,0,null,null,2,"tsp-ga",[],null,null,null,s,A)),o._10(512,null,c,c,[p,m,g]),o.X(2,4243456,null,0,_,[x.h,c,r.a,M,G,P],null,null)],null,null)},{},{},[]),T=n("Un6q"),I=n("UHIZ"),S=n("T2Au");n.d(e,"TSPGAModuleNgFactory",function(){return z});var z=o.V(a,[],function(t){return o._7([o._8(512,o.j,o.S,[[8,[O]],[3,o.j],o.u]),o._8(4608,T.i,T.h,[o.r,[2,T.m]]),o._8(4608,M,M,[]),o._8(4608,p,p,[M]),o._8(5120,r.a,u,[]),o._8(4608,g,g,[r.a,M]),o._8(4608,m,m,[g,M,r.a]),o._8(4608,c,c,[p,m,g]),o._8(4608,f,f,[]),o._8(4608,G,G,[r.a]),o._8(4608,P,P,[r.a]),o._8(512,T.b,T.b,[]),o._8(512,I.m,I.m,[[2,I.r],[2,I.k]]),o._8(512,S.a,S.a,[]),o._8(512,a,a,[]),o._8(1024,I.i,function(){return[[{path:"",component:_,pathMatch:"full"}]]},[])])})}});